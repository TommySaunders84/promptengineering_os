<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Integrated Architecture: Cells, Knowledge Graph, and MCP</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0a0f1b;
            color: #e0e6ed;
            overflow: hidden;
        }
        
        .container {
            width: 100vw;
            height: 100vh;
            position: relative;
            display: flex;
        }
        
        .main-view {
            flex: 1;
            position: relative;
            overflow: hidden;
        }
        
        .layer-indicator {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(13, 21, 32, 0.95);
            border: 1px solid rgba(56, 178, 172, 0.3);
            border-radius: 8px;
            padding: 15px;
            width: 200px;
        }
        
        .layer-item {
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 13px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .layer-item.active {
            background: rgba(56, 178, 172, 0.3);
            border: 1px solid #4fd1c5;
        }
        
        .layer-item:hover {
            background: rgba(56, 178, 172, 0.2);
        }
        
        .layer-icon {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
        }
        
        svg {
            width: 100%;
            height: 100%;
        }
        
        /* Cell styles */
        .cell {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .cell-body {
            fill: rgba(17, 24, 39, 0.9);
            stroke: #38b2ac;
            stroke-width: 2;
            filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.3));
        }
        
        .cell:hover .cell-body {
            fill: rgba(17, 24, 39, 1);
            stroke: #4fd1c5;
            stroke-width: 3;
        }
        
        /* Knowledge Graph styles */
        .kg-node {
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .kg-node.visible {
            opacity: 1;
        }
        
        .kg-node-circle {
            fill: rgba(147, 197, 253, 0.8);
            stroke: #93c5fd;
            stroke-width: 2;
        }
        
        .kg-edge {
            stroke: rgba(147, 197, 253, 0.4);
            stroke-width: 1.5;
            fill: none;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .kg-edge.visible {
            opacity: 1;
        }
        
        /* MCP styles */
        .mcp-connector {
            stroke: rgba(251, 191, 36, 0.6);
            stroke-width: 3;
            fill: none;
            stroke-dasharray: 5, 5;
            opacity: 0;
            transition: opacity 0.5s ease;
            filter: drop-shadow(0 0 4px rgba(251, 191, 36, 0.4));
        }
        
        .mcp-connector.visible {
            opacity: 1;
            animation: dash 20s linear infinite;
        }
        
        @keyframes dash {
            to {
                stroke-dashoffset: -100;
            }
        }
        
        .mcp-hub {
            fill: rgba(251, 191, 36, 0.2);
            stroke: #fbbf24;
            stroke-width: 3;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .mcp-hub.visible {
            opacity: 1;
        }
        
        .control-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(13, 21, 32, 0.95);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid rgba(56, 178, 172, 0.3);
            max-width: 300px;
        }
        
        .control-title {
            font-size: 18px;
            font-weight: 600;
            color: #4fd1c5;
            margin-bottom: 15px;
        }
        
        .control-section {
            margin-bottom: 15px;
        }
        
        .control-label {
            font-size: 12px;
            color: #94a3b8;
            margin-bottom: 5px;
        }
        
        button {
            background: rgba(56, 178, 172, 0.2);
            border: 1px solid #38b2ac;
            color: #e0e6ed;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 8px;
            margin-bottom: 8px;
            transition: all 0.2s ease;
            font-size: 12px;
        }
        
        button:hover {
            background: rgba(56, 178, 172, 0.3);
            border-color: #4fd1c5;
        }
        
        button.active {
            background: rgba(56, 178, 172, 0.5);
            border-color: #4fd1c5;
        }
        
        .info-panel {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(13, 21, 32, 0.95);
            padding: 15px 20px;
            border-radius: 8px;
            border: 1px solid rgba(56, 178, 172, 0.3);
            max-width: 400px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .info-panel.visible {
            opacity: 1;
        }
        
        .info-title {
            font-size: 16px;
            font-weight: 600;
            color: #4fd1c5;
            margin-bottom: 10px;
        }
        
        .info-content {
            font-size: 13px;
            line-height: 1.6;
            color: #cbd5e1;
        }
        
        .connection {
            fill: none;
            stroke: rgba(56, 178, 172, 0.3);
            stroke-width: 2;
            transition: all 0.3s ease;
        }
        
        .text-label {
            fill: #e0e6ed;
            font-size: 14px;
            font-weight: 600;
        }
        
        .text-sublabel {
            fill: #94a3b8;
            font-size: 11px;
        }
        
        .kg-label {
            fill: #93c5fd;
            font-size: 11px;
            text-anchor: middle;
        }
        
        .mcp-label {
            fill: #fbbf24;
            font-size: 14px;
            font-weight: 600;
            text-anchor: middle;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="main-view">
            <svg id="architecture-svg"></svg>
            
            <div class="control-panel">
                <div class="control-title">Architecture Layers</div>
                
                <div class="control-section">
                    <div class="control-label">View Modes</div>
                    <button id="cellBtn" onclick="showLayer('cells')" class="active">Cell Architecture</button>
                    <button id="kgBtn" onclick="showLayer('knowledge')">Knowledge Graph</button>
                    <button id="mcpBtn" onclick="showLayer('mcp')">MCP Integration</button>
                    <button id="allBtn" onclick="showLayer('all')">All Layers</button>
                </div>
                
                <div class="control-section">
                    <div class="control-label">Interactions</div>
                    <button onclick="animateDataFlow()">Show Data Flow</button>
                    <button onclick="simulateAIQuery()">AI Query Demo</button>
                </div>
            </div>
            
            <div class="layer-indicator">
                <div class="layer-item active" onclick="showLayer('cells')">
                    <span>Cell Architecture</span>
                    <span class="layer-icon" style="background: #38b2ac;"></span>
                </div>
                <div class="layer-item" onclick="showLayer('knowledge')">
                    <span>Knowledge Graph</span>
                    <span class="layer-icon" style="background: #93c5fd;"></span>
                </div>
                <div class="layer-item" onclick="showLayer('mcp')">
                    <span>MCP Layer</span>
                    <span class="layer-icon" style="background: #fbbf24;"></span>
                </div>
            </div>
            
            <div class="info-panel" id="infoPanel">
                <div class="info-title" id="infoTitle"></div>
                <div class="info-content" id="infoContent"></div>
            </div>
        </div>
    </div>

    <script>
        const svg = document.getElementById('architecture-svg');
        let currentLayer = 'cells';
        
        // Cell architecture data
        const cells = [
            { id: 'account', name: 'Account Management', x: 200, y: 200 },
            { id: 'payment', name: 'Payment Processing', x: 450, y: 150 },
            { id: 'fraud', name: 'Fraud Detection', x: 700, y: 200 },
            { id: 'kyc', name: 'KYC Compliance', x: 150, y: 400 },
            { id: 'ledger', name: 'General Ledger', x: 350, y: 350 },
            { id: 'notification', name: 'Notification Service', x: 600, y: 400 },
            { id: 'analytics', name: 'Analytics Engine', x: 800, y: 350 }
        ];
        
        // Knowledge graph entities
        const kgNodes = [
            { id: 'customer', label: 'Customer', x: 300, y: 250 },
            { id: 'account_entity', label: 'Account', x: 450, y: 200 },
            { id: 'transaction', label: 'Transaction', x: 600, y: 250 },
            { id: 'risk_profile', label: 'Risk Profile', x: 750, y: 300 },
            { id: 'identity', label: 'Identity', x: 200, y: 350 },
            { id: 'compliance', label: 'Compliance Status', x: 350, y: 450 },
            { id: 'balance', label: 'Balance', x: 500, y: 350 },
            { id: 'alert', label: 'Alert', x: 650, y: 450 }
        ];
        
        const kgEdges = [
            { from: 'customer', to: 'account_entity', label: 'owns' },
            { from: 'account_entity', to: 'transaction', label: 'contains' },
            { from: 'customer', to: 'risk_profile', label: 'has' },
            { from: 'customer', to: 'identity', label: 'verified_by' },
            { from: 'identity', to: 'compliance', label: 'determines' },
            { from: 'account_entity', to: 'balance', label: 'maintains' },
            { from: 'transaction', to: 'risk_profile', label: 'affects' },
            { from: 'risk_profile', to: 'alert', label: 'triggers' }
        ];
        
        function initializeVisualization() {
            // Create groups for different layers
            const cellGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            cellGroup.setAttribute('id', 'cell-layer');
            
            const kgGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            kgGroup.setAttribute('id', 'kg-layer');
            
            const mcpGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            mcpGroup.setAttribute('id', 'mcp-layer');
            
            // Draw cell connections first (background)
            const connectionGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            cells.forEach((cell, i) => {
                cells.slice(i + 1).forEach(otherCell => {
                    if (Math.random() > 0.6) { // Random connections for demo
                        const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                        const d = `M ${cell.x + 75} ${cell.y + 40} L ${otherCell.x + 75} ${otherCell.y + 40}`;
                        path.setAttribute('d', d);
                        path.setAttribute('class', 'connection');
                        connectionGroup.appendChild(path);
                    }
                });
            });
            cellGroup.appendChild(connectionGroup);
            
            // Draw cells
            cells.forEach(cell => {
                const group = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                group.setAttribute('class', 'cell');
                group.setAttribute('transform', `translate(${cell.x}, ${cell.y})`);
                
                const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                rect.setAttribute('class', 'cell-body');
                rect.setAttribute('width', '150');
                rect.setAttribute('height', '80');
                rect.setAttribute('rx', '8');
                
                const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.setAttribute('class', 'text-label');
                text.setAttribute('x', '75');
                text.setAttribute('y', '45');
                text.setAttribute('text-anchor', 'middle');
                text.textContent = cell.name;
                
                group.appendChild(rect);
                group.appendChild(text);
                
                group.addEventListener('click', () => showInfo('cell', cell));
                
                cellGroup.appendChild(group);
            });
            
            // Draw knowledge graph edges
            kgEdges.forEach(edge => {
                const fromNode = kgNodes.find(n => n.id === edge.from);
                const toNode = kgNodes.find(n => n.id === edge.to);
                
                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                path.setAttribute('d', `M ${fromNode.x} ${fromNode.y} L ${toNode.x} ${toNode.y}`);
                path.setAttribute('class', 'kg-edge');
                kgGroup.appendChild(path);
            });
            
            // Draw knowledge graph nodes
            kgNodes.forEach(node => {
                const group = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                group.setAttribute('class', 'kg-node');
                group.setAttribute('transform', `translate(${node.x}, ${node.y})`);
                
                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('class', 'kg-node-circle');
                circle.setAttribute('r', '30');
                
                const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.setAttribute('class', 'kg-label');
                text.setAttribute('y', '5');
                text.textContent = node.label;
                
                group.appendChild(circle);
                group.appendChild(text);
                
                group.addEventListener('click', () => showInfo('kg', node));
                
                kgGroup.appendChild(group);
            });
            
            // Draw MCP hub
            const mcpHub = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            mcpHub.setAttribute('transform', 'translate(500, 100)');
            
            const mcpRect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
            mcpRect.setAttribute('class', 'mcp-hub');
            mcpRect.setAttribute('x', '-100');
            mcpRect.setAttribute('y', '-30');
            mcpRect.setAttribute('width', '200');
            mcpRect.setAttribute('height', '60');
            mcpRect.setAttribute('rx', '30');
            
            const mcpText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            mcpText.setAttribute('class', 'mcp-label');
            mcpText.setAttribute('y', '5');
            mcpText.textContent = 'MCP Gateway';
            
            mcpHub.appendChild(mcpRect);
            mcpHub.appendChild(mcpText);
            mcpGroup.appendChild(mcpHub);
            
            // Draw MCP connections to cells
            cells.forEach(cell => {
                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                path.setAttribute('d', `M 500 130 L ${cell.x + 75} ${cell.y}`);
                path.setAttribute('class', 'mcp-connector');
                mcpGroup.appendChild(path);
            });
            
            // Add AI model representations
            const aiModels = [
                { name: 'Claude', x: 150, y: 50 },
                { name: 'Risk Model', x: 500, y: 30 },
                { name: 'Analytics AI', x: 850, y: 50 }
            ];
            
            aiModels.forEach(model => {
                const group = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                group.setAttribute('transform', `translate(${model.x}, ${model.y})`);
                
                const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                rect.setAttribute('class', 'mcp-hub');
                rect.setAttribute('x', '-40');
                rect.setAttribute('y', '-15');
                rect.setAttribute('width', '80');
                rect.setAttribute('height', '30');
                rect.setAttribute('rx', '15');
                
                const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.setAttribute('class', 'mcp-label');
                text.setAttribute('y', '5');
                text.setAttribute('font-size', '12');
                text.textContent = model.name;
                
                group.appendChild(rect);
                group.appendChild(text);
                
                // Connect to MCP hub
                const connector = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                connector.setAttribute('d', `M ${model.x} ${model.y + 15} L 500 70`);
                connector.setAttribute('class', 'mcp-connector');
                mcpGroup.insertBefore(connector, mcpGroup.firstChild);
                
                mcpGroup.appendChild(group);
            });
            
            svg.appendChild(cellGroup);
            svg.appendChild(kgGroup);
            svg.appendChild(mcpGroup);
            
            // Initialize with cells visible
            showLayer('cells');
        }
        
        function showLayer(layer) {
            currentLayer = layer;
            
            // Update button states
            document.querySelectorAll('button').forEach(btn => btn.classList.remove('active'));
            if (layer === 'cells') document.getElementById('cellBtn').classList.add('active');
            else if (layer === 'knowledge') document.getElementById('kgBtn').classList.add('active');
            else if (layer === 'mcp') document.getElementById('mcpBtn').classList.add('active');
            else if (layer === 'all') document.getElementById('allBtn').classList.add('active');
            
            // Update layer indicator
            document.querySelectorAll('.layer-item').forEach(item => item.classList.remove('active'));
            if (layer !== 'all') {
                document.querySelector(`.layer-item:nth-child(${layer === 'cells' ? 1 : layer === 'knowledge' ? 2 : 3})`).classList.add('active');
            }
            
            // Show/hide layers
            const cellLayer = document.getElementById('cell-layer');
            const kgLayer = document.getElementById('kg-layer');
            const mcpLayer = document.getElementById('mcp-layer');
            
            if (layer === 'cells') {
                cellLayer.style.opacity = '1';
                kgLayer.style.opacity = '0.1';
                mcpLayer.style.opacity = '0.1';
                document.querySelectorAll('.kg-node, .kg-edge').forEach(el => el.classList.remove('visible'));
                document.querySelectorAll('.mcp-connector, .mcp-hub').forEach(el => el.classList.remove('visible'));
            } else if (layer === 'knowledge') {
                cellLayer.style.opacity = '0.2';
                kgLayer.style.opacity = '1';
                mcpLayer.style.opacity = '0.1';
                document.querySelectorAll('.kg-node, .kg-edge').forEach(el => el.classList.add('visible'));
                document.querySelectorAll('.mcp-connector, .mcp-hub').forEach(el => el.classList.remove('visible'));
            } else if (layer === 'mcp') {
                cellLayer.style.opacity = '0.3';
                kgLayer.style.opacity = '0.1';
                mcpLayer.style.opacity = '1';
                document.querySelectorAll('.kg-node, .kg-edge').forEach(el => el.classList.remove('visible'));
                document.querySelectorAll('.mcp-connector, .mcp-hub').forEach(el => el.classList.add('visible'));
            } else if (layer === 'all') {
                cellLayer.style.opacity = '0.8';
                kgLayer.style.opacity = '0.8';
                mcpLayer.style.opacity = '0.8';
                document.querySelectorAll('.kg-node, .kg-edge').forEach(el => el.classList.add('visible'));
                document.querySelectorAll('.mcp-connector, .mcp-hub').forEach(el => el.classList.add('visible'));
            }
            
            // Update info panel
            updateInfoForLayer(layer);
        }
        
        function showInfo(type, data) {
            const infoPanel = document.getElementById('infoPanel');
            const infoTitle = document.getElementById('infoTitle');
            const infoContent = document.getElementById('infoContent');
            
            if (type === 'cell') {
                infoTitle.textContent = data.name;
                infoContent.innerHTML = `
                    <strong>Cell Architecture Component</strong><br><br>
                    This autonomous cell manages its own data persistence, business logic, and API interfaces. 
                    It communicates with other cells through the service mesh for distributed operations.
                `;
            } else if (type === 'kg') {
                infoTitle.textContent = data.label;
                infoContent.innerHTML = `
                    <strong>Knowledge Graph Entity</strong><br><br>
                    Represents a semantic concept within the financial domain. This entity maintains 
                    relationships with other entities to form a comprehensive knowledge network.
                `;
            }
            
            infoPanel.classList.add('visible');
            setTimeout(() => infoPanel.classList.remove('visible'), 5000);
        }
        
        function updateInfoForLayer(layer) {
            const infoPanel = document.getElementById('infoPanel');
            const infoTitle = document.getElementById('infoTitle');
            const infoContent = document.getElementById('infoContent');
            
            if (layer === 'cells') {
                infoTitle.textContent = 'Cell-Based Architecture';
                infoContent.innerHTML = `
                    Vertically integrated services with autonomous operation. Each cell owns its complete 
                    domain from database to API, communicating through a service mesh topology.
                `;
            } else if (layer === 'knowledge') {
                infoTitle.textContent = 'Knowledge Graph Layer';
                infoContent.innerHTML = `
                    Semantic representation of business entities and their relationships. Enables 
                    intelligent querying and inference across the financial services domain.
                `;
            } else if (layer === 'mcp') {
                infoTitle.textContent = 'Model Context Protocol';
                infoContent.innerHTML = `
                    Standardized integration layer enabling AI models to access services and data. 
                    Provides unified interface for multiple AI systems to interact with the architecture.
                `;
            } else if (layer === 'all') {
                infoTitle.textContent = 'Integrated Architecture';
                infoContent.innerHTML = `
                    Complete ecosystem showing cell-based services, semantic knowledge relationships, 
                    and AI integration through MCP. Each layer complements the others for a comprehensive solution.
                `;
            }
            
            infoPanel.classList.add('visible');
            setTimeout(() => infoPanel.classList.remove('visible'), 4000);
        }
        
        function animateDataFlow() {
            // Create animated paths showing data flow
            const paths = document.querySelectorAll('.connection, .kg-edge, .mcp-connector');
            paths.forEach((path, index) => {
                setTimeout(() => {
                    path.style.stroke = '#4fd1c5';
                    path.style.strokeWidth = '4';
                    path.style.filter = 'drop-shadow(0 0 8px rgba(79, 209, 197, 0.8))';
                    
                    setTimeout(() => {
                        path.style.stroke = '';
                        path.style.strokeWidth = '';
                        path.style.filter = '';
                    }, 1000);
                }, index * 100);
            });
        }
        
        function simulateAIQuery() {
            showLayer('all');
            
            const infoPanel = document.getElementById('infoPanel');
            const infoTitle = document.getElementById('infoTitle');
            const infoContent = document.getElementById('infoContent');
            
            infoTitle.textContent = 'AI Query Simulation';
            infoContent.innerHTML = `
                <strong>Query:</strong> "What is the risk profile for customer transactions?"<br><br>
                1. AI model connects through MCP Gateway<br>
                2. Queries Knowledge Graph for customer-risk relationships<br>
                3. Accesses Payment and Fraud Detection cells<br>
                4. Returns comprehensive risk assessment
            `;
            
            infoPanel.classList.add('visible');
            
            // Animate the query path
            setTimeout(() => animateDataFlow(), 500);
            setTimeout(() => infoPanel.classList.remove('visible'), 8000);
        }
        
        // Initialize the visualization
        initializeVisualization();
    </script>
</body>
</html>
